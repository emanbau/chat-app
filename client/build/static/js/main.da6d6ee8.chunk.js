(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{103:function(e,t,n){},108:function(e,t,n){},145:function(e,t,n){"use strict";n.r(t);var c,a,o=n(2),s=n(37),r=n.n(s),i=(n(103),n(39)),u=n(158),l=n(53),j=n(146),d=n(144),b=n(88),g=n(34),O=function(){return Object(g.b)()},p=g.c,m=n(26),h=Object(m.b)({name:"loggedin",initialState:{loggedin:!1},reducers:{login:function(e){e.loggedin=!0},logout:function(e){e.loggedin=!1}}}),f=h.actions,x=f.login,v=(f.logout,h.reducer),w=n(19),N=n(159),S=n(84),y=n(25),k=Object(y.a)(c||(c=Object(S.a)(["\n    query getUser(\n        $username: String!\n        $password: String!\n    ) {\n        getUser(\n            username: $username\n            password: $password\n        ) {\n            username\n            password\n        }\n    }\n"]))),E=Object(m.b)({name:"account",initialState:{account:{username:"",password:""}},reducers:{setUsername:function(e,t){e.account.username=t.payload},setPassword:function(e,t){e.account.password=t.payload},logout:function(e){e.account.password="",e.account.password=""}}}),C=E.actions,L=C.setUsername,U=C.setPassword,$=(C.logout,E.reducer),J=(n(108),n(4)),P=function(e){var t=e.loginHandle,n=Object(o.useState)(""),c=Object(w.a)(n,2),a=c[0],s=c[1],r=Object(o.useState)(""),i=Object(w.a)(r,2),u=i[0],l=i[1],j=Object(N.a)(k,{variables:{username:a,password:u}}),d=Object(w.a)(j,2),b=d[0],g=d[1],p=g.error,m=g.loading,h=g.data,f=O();return Object(o.useEffect)((function(){p&&console.error(p),m||console.log(h)}),[p,m,h]),Object(o.useEffect)((function(){h&&(f(L(a)),f(U(u)),t())}),[h,a,u,f,t]),Object(J.jsxs)("div",{className:"login-container",children:[Object(J.jsx)("h1",{className:"login-heading",children:"Login"}),Object(J.jsx)("p",{className:"login-caption",children:"Start chatting today!"}),Object(J.jsx)("input",{type:"text",placeholder:"Username",onChange:function(e){return s(e.target.value)},className:"username-input"}),Object(J.jsx)("input",{type:"text",placeholder:"Password",onChange:function(e){return l(e.target.value)},className:"password-input"}),Object(J.jsx)("button",{className:"login-button",onClick:function(){return b()},children:"Log In"})]})},_=n(57),q=n.n(_),H=n(86),I=n(59),Q=n(87),R=function(){var e=Object(o.useState)(!1),t=Object(w.a)(e,2),n=t[0],c=t[1],s=Object(o.useState)(""),r=Object(w.a)(s,2),i=r[0],u=r[1],l=p((function(e){return e.account.account.username})),j=Object(o.useState)([]),d=Object(w.a)(j,2),b=d[0],g=d[1],O=Object(o.useState)(""),m=Object(w.a)(O,2),h=m[0],f=m[1];Object(o.useEffect)((function(){a=Object(Q.io)("localhost:3001/")}),[]);Object(o.useEffect)((function(){a.on("receive_message",(function(e){g([].concat(Object(I.a)(b),[e]))}))}));var x=function(){var e=Object(H.a)(q.a.mark((function e(){var t;return q.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={room:i,content:{author:l,message:h}},g([].concat(Object(I.a)(b),[t.content])),f(""),e.next=5,a.emit("send_message",t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(J.jsx)("div",{children:n?Object(J.jsxs)("div",{className:"messenger-page-container",children:[Object(J.jsx)("div",{className:"chat-container",children:b.map((function(e){return Object(J.jsxs)("div",{className:"messageList-container",children:[Object(J.jsx)("p",{children:e.author}),Object(J.jsx)("div",{className:"message",children:Object(J.jsx)("p",{children:e.message})})]})}))}),Object(J.jsxs)("div",{className:"message-input-container",children:[Object(J.jsx)("input",{type:"text",placeholder:"Message",value:h,onChange:function(e){return f(e.target.value)}}),Object(J.jsx)("button",{onClick:x,children:"Send"})]})]}):Object(J.jsxs)("div",{className:"room-selector",children:[Object(J.jsx)("input",{type:"text",onChange:function(e){return u(e.target.value)},placeholder:"Enter Room Name"}),Object(J.jsx)("button",{onClick:function(){c(!0),a.emit("join_room",i)},children:"Join Room"})]})})},A=Object(b.a)((function(e){var t=e.graphQLErrors,n=e.networkError;t&&t.map((function(e){var t=e.message;return console.log("GraphQL error ".concat(t)),null})),n&&console.log(n)})),B=Object(i.from)([A,new u.a({uri:"http://localhost:3001/graphql"})]),G=new l.a({cache:new j.a,link:B}),M=function(){var e=p((function(e){return e.loggedin.loggedin})),t=O();return Object(J.jsx)(d.a,{client:G,children:Object(J.jsx)("div",{className:"App",children:e?Object(J.jsx)(R,{}):Object(J.jsx)(P,{loginHandle:function(){t(x())}})})})},z=Object(m.a)({reducer:{loggedin:v,account:$}});r.a.render(Object(J.jsx)(g.a,{store:z,children:Object(J.jsx)(M,{})}),document.getElementById("root"))}},[[145,1,2]]]);
//# sourceMappingURL=main.da6d6ee8.chunk.js.map